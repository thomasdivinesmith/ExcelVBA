Public Sub GetSelectedCellsNamedRanges()
'Date: 8/7/18
'Author: Thomas Divine Smith
'Project: Excel VBA
'Purpose: Writes a function to return the value of
'all the selected cells named ranges

'Instructions: Select your cells & run this macro
'The result will then appear in your immediates window

On Error Resume Next

    Dim c As Range
    
    'Get named ranges of each selected cell
    For Each c In Selection
        'Get cell named range
        Dim cell_name As String
        cell_name = c.Name.Name
        
        'Get named range with quotations
        Dim named_range As String
        named_range = (Chr(34) & cell_name & Chr(34))
        
        'Create function that returns value of cell
        
        'Name Function
        Dim func_title As String
        func_title = "Public Shared Function " & cell_name
        
        'Return value
        Dim func_return As String
        func_return = "Return xl" & ActiveSheet.Name & ".Range(" & named_range & ").value"
        
        'End Function
        Dim func_end
        func_end = "End Function"
        
        'Remove sheet name referance
        Dim remove_string As String
        remove_string = ActiveSheet.Name & "!"
        
        'Remove sheet name referance in function title
        If InStr(func_title, remove_string) Then
            func_title = Replace(func_title, remove_string, "")
        End If
        
        'Remove sheet name referance in named range
        If InStr(named_range, remove_string) Then
            named_range = Replace(named_range, remove_string, "")
        End If
        
        Debug.Print (func_title)
        Debug.Print (func_return)
        Debug.Print (func_end)
        
        'OUPUT EXAMPLE
        'Function iP_Color()
        '    Return xliProperties.Range("iP_Color").value
        'End Function
    Next

End Sub
